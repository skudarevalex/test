# ML Service для предсказания зарплаты

Этот проект представляет собой веб-приложение для предсказания зарплаты на основе различных параметров работы и компании. Приложение использует модель машинного обучения CatBoost для выполнения предсказаний.

## Основные функции

- Регистрация и аутентификация пользователей
- Управление балансом пользователя
- Отправка запросов на предсказание зарплаты
- Асинхронная обработка запросов с использованием RabbitMQ
- Просмотр истории предсказаний

## Структура проекта

```
.
├── app
│   ├── database
│   ├── models
│   ├── routes
│   ├── services
│   │   └── crud
│   ├── tests
│   ├── webui
│   │   └── auth
│   └── workers
├── nginx
└── docker-compose.yaml
```

## Технологии

- FastAPI
- SQLModel
- PostgreSQL
- RabbitMQ
- Streamlit (для веб-интерфейса)
- CatBoost (для модели машинного обучения)
- Docker и Docker Compose

## Установка и запуск

1. Клонируйте репозиторий:
   ```
   git clone <url-репозитория>
   cd <директория-проекта>
   ```

2. Создайте файл `.env` в корневой директории проекта и заполните его необходимыми переменными окружения:
   ```
   DB_HOST=database
   DB_PORT=5432
   DB_USER=your_username
   DB_PASS=your_password
   DB_NAME=your_database_name
   RABBITMQ_USER=your_rabbitmq_user
   RABBITMQ_PASS=your_rabbitmq_password
   RABBITMQ_HOST=rabbitmq
   RABBITMQ_PORT=5672
   ```

3. Запустите проект с помощью Docker Compose:
   ```
   docker-compose up --build
   ```

4. Откройте веб-интерфейс по адресу `http://localhost:8501`

## API эндпойнты

- `/user/register` (POST): Регистрация нового пользователя
- `/user/login` (POST): Аутентификация пользователя
- `/balance/{user_id}` (GET): Получение баланса пользователя
- `/balance/{user_id}/add` (POST): Пополнение баланса пользователя
- `/prediction/predict_salary` (POST): Создание задачи на предсказание зарплаты
- `/prediction/prediction_status/{task_id}` (GET): Получение статуса задачи предсказания

## Тестирование

Для запуска тестов используйте следующую команду:

```
pytest app/tests
```

## Разработка

Проект разделен на несколько компонентов:
- `app`: Основное FastAPI приложение
- `webui`: Streamlit веб-интерфейс
- `workers`: Воркеры для обработки задач предсказания
- `nginx`: Прокси-сервер для маршрутизации запросов

При разработке новых функций, пожалуйста, следуйте существующей структуре проекта и добавляйте соответствующие тесты.

## Вклад в проект

Если вы хотите внести свой вклад в проект, пожалуйста, создайте pull request с описанием предлагаемых изменений.

## Лицензия

Этот проект лицензирован под MIT License - см. файл [LICENSE](LICENSE) для деталей.