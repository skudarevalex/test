# Веб-приложение ML сервиса

Это веб-приложение предоставляет пользовательский интерфейс для управления личными аккаунтами в ML сервисе. Пользователи могут регистрироваться, входить в систему, просматривать свой баланс, пополнять счет, отправлять запросы в ML сервис и просматривать историю своих запросов и предсказаний.

## Оглавление

- [Обзор проекта](#обзор-проекта)
- [Функциональность](#функциональность)
- [Структура проекта](#структура-проекта)
- [Установка и настройка](#установка-и-настройка)
- [Запуск приложения](#запуск-приложения)
- [API эндпойнты](#api-эндпойнты)
- [Веб-интерфейс](#веб-интерфейс)
- [Тестирование](#тестирование)
- [Переменные окружения](#переменные-окружения)

## Обзор проекта

Этот проект представляет собой веб-приложение для управления учетными записями пользователей в ML сервисе. Оно позволяет пользователям регистрироваться, входить в систему, просматривать свой баланс, пополнять его, отправлять запросы в ML сервис и просматривать историю своих запросов и предсказаний.

## Функциональность

- Регистрация и аутентификация пользователей
- Управление балансом
- Запросы к ML сервису и получение предсказаний
- История запросов и предсказаний
- Валидация данных
- Проверка баланса перед обработкой запросов

## Структура проекта

```
app/
├── database/
├── models/
├── routes/
├── services/
│   └── crud/
├── tests/
├── webui/
│   └── auth/
├── api.py
├── main.py
├── Dockerfile
├── requirements.txt
└── .env
```

## Установка и настройка

1. Клонируйте репозиторий:
   ```
   git clone https://git.lab.karpov.courses/a-skudarev/ml_services_project
   cd ml-service-webapp
   ```

2. Настройте переменные окружения:
   Создайте файл `.env` в корневой директории и добавьте необходимые переменные окружения (см. раздел [Переменные окружения](#переменные-окружения)).

3. Соберите Docker контейнеры:
   ```
   docker-compose build
   ```

4. Запустите Docker контейнеры:
   ```
   docker-compose up
   ```

## Запуск приложения

- Доступ к веб-интерфейсу: `http://localhost:8501`
- Доступ к документации API: `http://localhost:8080/docs`

## API эндпойнты

### Эндпойнты пользователей
- `POST /user/register`: Регистрация нового пользователя
- `POST /user/login`: Вход пользователя и получение JWT токена

### Эндпойнты баланса
- `GET /balance/{user_id}`: Получение баланса пользователя
- `POST /balance/{user_id}/add`: Добавление кредитов на баланс пользователя

### Эндпойнты предсказаний
- `POST /prediction`: Отправка запроса на предсказание

### Эндпойнты истории
- `GET /history/{user_id}`: Получение истории предсказаний пользователя

## Веб-интерфейс

- Главная страница (`/`): Обзор возможностей ML сервиса
- Регистрация (`/register`): Регистрация пользователя
- Вход (`/login`): Вход пользователя
- Личный кабинет (`/dashboard`): Личный кабинет пользователя
- Баланс (`/balance`): Просмотр и пополнение баланса
- Предсказания (`/prediction`): Отправка запросов на предсказания
- История (`/history`): Просмотр истории предсказаний

## Тестирование

- Тесты сервисов: `test_userservice.py`, `test_mlservice.py`
- Тесты API: `test_user_api.py`, `test_balance_api.py`, `test_prediction_api.py`, `test_history_api.py`
- Тесты базы данных: `test_database.py`

## Переменные окружения

- `DB_HOST`: Хост базы данных
- `DB_PORT`: Порт базы данных
- `DB_USER`: Пользователь базы данных
- `DB_PASS`: Пароль базы данных
- `DB_NAME`: Имя базы данных
- `RABBITMQ_USER`: Пользователь RabbitMQ
- `RABBITMQ_PASS`: Пароль RabbitMQ
- `RABBITMQ_HOST`: Хост RabbitMQ
- `RABBITMQ_PORT`: Порт RabbitMQ

Для более подробной информации, пожалуйста, обратитесь к документации проекта.
